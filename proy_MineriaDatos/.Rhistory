trainbd<-bd_lp2[index==1,]
testbd<-bd_lp2[index==2,]
m1<-glm(ind_feminicidio~.,data=trainbd,family = binomial(link="logit"))
summary(m1)
m2<-step(m1)
summary(m2)
clase<-predict(m2,testbd,type="response")>0.5
table(clase)
table(testbd$ind_feminicidio,clase)
library(caret)
confusionMatrix(table(testbd$ind_feminicidio,clase))
library(mfx)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.5,xlim=c(-0.7,0.70),pos=-0.02)
bd_lp<-bd_cas %>% dplyr::select(aux)
bd_lp<-bd_lp %>% mutate(fem1=S3_10_13=="1. Muchas veces"|S3_10_14=="1. Muchas veces"|S3_10_15=="1. Muchas veces"|S3_10_16=="1. Muchas veces"|S3_10_18=="1. Muchas veces"|S3_10_19=="1. Muchas veces")
bd_lp<-bd_lp %>% mutate(fem2=S3_10_13=="2. Pocas veces"|S3_10_14=="2. Pocas veces"|S3_10_15=="2. Pocas veces"|S3_10_16=="2. Pocas veces"|S3_10_18=="2. Pocas veces"|S3_10_19=="2. Pocas veces")
bd_lp<-bd_lp %>% mutate(fem3=S3_10_13=="3. Una vez"|S3_10_14=="3. Una vez"|S3_10_15=="3. Una vez"|S3_10_16=="3. Una vez"|S3_10_18=="3. Una vez"|S3_10_19=="3. Una vez")
bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE|fem3==TRUE))
aux2<-c("1. Muchas veces","2. Pocas veces","3. Una vez")
table(bd_lp$ind_feminicidio)
var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2","fem3")
#var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2")
bd_lp2<-bd_lp %>% dplyr::select(-var_elim)
bd_lp2<-bd_lp2 %>% mutate(pal_gros=S3_10_01==unique(bd_lp2$S3_10_01)[1]|S3_10_01==unique(bd_lp2$S3_10_01)[2]|S3_10_01==unique(bd_lp2$S3_10_01)[3])
bd_lp2<-bd_lp2 %>% mutate(humillacion=S3_10_02==unique(bd_lp2$S3_10_02)[1]|S3_10_02==unique(bd_lp2$S3_10_02)[2]|S3_10_02==unique(bd_lp2$S3_10_02)[3])
bd_lp2<-bd_lp2 %>% mutate(prohib_sal=S3_10_03==unique(bd_lp2$S3_10_03)[1]|S3_10_03==unique(bd_lp2$S3_10_03)[2]|S3_10_03==unique(bd_lp2$S3_10_03)[3])
bd_lp2<-bd_lp2 %>% mutate(amenaza_last=S3_10_04==unique(bd_lp2$S3_10_04)[1]|S3_10_04==unique(bd_lp2$S3_10_04)[2]|S3_10_04==unique(bd_lp2$S3_10_04)[3])
bd_lp2<-bd_lp2 %>% mutate(amenaza_matar=S3_10_05==unique(bd_lp2$S3_10_05)[1]|S3_10_05==unique(bd_lp2$S3_10_05)[2]|S3_10_05==unique(bd_lp2$S3_10_05)[3])
bd_lp2<-bd_lp2 %>% mutate(quitar_hijos=S3_10_06==unique(bd_lp2$S3_10_06)[1]|S3_10_06==unique(bd_lp2$S3_10_06)[2]|S3_10_06==unique(bd_lp2$S3_10_06)[3])
bd_lp2<-bd_lp2 %>% mutate(no_gast_casa=S3_10_07==unique(bd_lp2$S3_10_07)[1]|S3_10_07==unique(bd_lp2$S3_10_07)[2]|S3_10_07==unique(bd_lp2$S3_10_07)[3])
bd_lp2<-bd_lp2 %>% mutate(prohib_prop=S3_10_08==unique(bd_lp2$S3_10_08)[1]|S3_10_08==unique(bd_lp2$S3_10_08)[2]|S3_10_08==unique(bd_lp2$S3_10_08)[3])
bd_lp2<-bd_lp2 %>% mutate(destruido_cosas=S3_10_09==unique(bd_lp2$S3_10_09)[1]|S3_10_09==unique(bd_lp2$S3_10_09)[2]|S3_10_09==unique(bd_lp2$S3_10_09)[3])
bd_lp2<-bd_lp2 %>% mutate(quit_dinero=S3_10_10==unique(bd_lp2$S3_10_10)[1]|S3_10_10==unique(bd_lp2$S3_10_10)[2]|S3_10_10==unique(bd_lp2$S3_10_10)[3])
bd_lp2<-bd_lp2 %>% mutate(quit_bien=S3_10_11==unique(bd_lp2$S3_10_11)[1]|S3_10_11==unique(bd_lp2$S3_10_11)[2]|S3_10_11==unique(bd_lp2$S3_10_11)[3])
bd_lp2<-bd_lp2 %>% mutate(empujado=S3_10_12==unique(bd_lp2$S3_10_12)[1]|S3_10_12==unique(bd_lp2$S3_10_12)[2]|S3_10_12==unique(bd_lp2$S3_10_12)[3])
bd_lp2<-bd_lp2 %>% mutate(amenaza_armas=S3_10_17==unique(bd_lp2$S3_10_17)[1]|S3_10_17==unique(bd_lp2$S3_10_17)[2]|S3_10_17==unique(bd_lp2$S3_10_17)[3])
bd_lp2<-bd_lp2 %>% mutate(oblig_rela=S3_10_20==unique(bd_lp2$S3_10_20)[1]|S3_10_20==unique(bd_lp2$S3_10_20)[2]|S3_10_20==unique(bd_lp2$S3_10_20)[3])
bd_lp2<-bd_lp2 %>% mutate(exige_rela=S3_10_21==unique(bd_lp2$S3_10_21)[1]|S3_10_21==unique(bd_lp2$S3_10_21)[2]|S3_10_21==unique(bd_lp2$S3_10_21)[3])
bd_lp2<-bd_lp2 %>% mutate(obliga_no_gusta=S3_10_22==unique(bd_lp2$S3_10_22)[1]|S3_10_22==unique(bd_lp2$S3_10_22)[2]|S3_10_22==unique(bd_lp2$S3_10_22)[3])
bd_lp2<-bd_lp2 %>% dplyr::select(-c(1:16))
set.seed(123)
index = sample(1:2, nrow(bd_lp2), replace = TRUE, prob=c(0.7, 0.3))
prop.table(table(index))
trainbd<-bd_lp2[index==1,]
testbd<-bd_lp2[index==2,]
m1<-glm(ind_feminicidio~.,data=trainbd,family = binomial(link="logit"))
summary(m1)
m2<-step(m1)
summary(m2)
clase<-predict(m2,testbd,type="response")>0.5
table(clase)
table(testbd$ind_feminicidio,clase)
library(caret)
confusionMatrix(table(testbd$ind_feminicidio,clase))
library(mfx)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.5,xlim=c(-0.7,0.70),pos=-0.02)
bd_lp<-bd_cas %>% dplyr::select(aux)
levels(bd_lp$S3_10_13)
table(is.na(bd_lp))
bd_lp<-bd_lp %>% mutate(fem1=S3_10_13=="1. Muchas veces"|S3_10_14=="1. Muchas veces"|S3_10_15=="1. Muchas veces"|S3_10_16=="1. Muchas veces"|S3_10_18=="1. Muchas veces"|S3_10_19=="1. Muchas veces")
bd_lp<-bd_lp %>% mutate(fem2=S3_10_13=="2. Pocas veces"|S3_10_14=="2. Pocas veces"|S3_10_15=="2. Pocas veces"|S3_10_16=="2. Pocas veces"|S3_10_18=="2. Pocas veces"|S3_10_19=="2. Pocas veces")
#bd_lp<-bd_lp %>% mutate(fem3=S3_10_13=="3. Una vez"|S3_10_14=="3. Una vez"|S3_10_15=="3. Una vez"|S3_10_16=="3. Una vez"|S3_10_18=="3. Una vez"|S3_10_19=="3. Una vez")
#bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE|fem3==TRUE))
bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE))
aux2<-c("1. Muchas veces","2. Pocas veces","3. Una vez")
table(bd_lp$ind_feminicidio)
#var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2","fem3")
var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2")
bd_lp2<-bd_lp %>% dplyr::select(-var_elim)
Hmisc::describe(bd_lp2)
bd_lp2<-bd_lp2 %>% mutate(pal_gros=S3_10_01==unique(bd_lp2$S3_10_01)[1]|S3_10_01==unique(bd_lp2$S3_10_01)[2]|S3_10_01==unique(bd_lp2$S3_10_01)[3])
bd_lp2<-bd_lp2 %>% mutate(humillacion=S3_10_02==unique(bd_lp2$S3_10_02)[1]|S3_10_02==unique(bd_lp2$S3_10_02)[2]|S3_10_02==unique(bd_lp2$S3_10_02)[3])
bd_lp2<-bd_lp2 %>% mutate(prohib_sal=S3_10_03==unique(bd_lp2$S3_10_03)[1]|S3_10_03==unique(bd_lp2$S3_10_03)[2]|S3_10_03==unique(bd_lp2$S3_10_03)[3])
bd_lp2<-bd_lp2 %>% mutate(amenaza_last=S3_10_04==unique(bd_lp2$S3_10_04)[1]|S3_10_04==unique(bd_lp2$S3_10_04)[2]|S3_10_04==unique(bd_lp2$S3_10_04)[3])
bd_lp2<-bd_lp2 %>% mutate(amenaza_matar=S3_10_05==unique(bd_lp2$S3_10_05)[1]|S3_10_05==unique(bd_lp2$S3_10_05)[2]|S3_10_05==unique(bd_lp2$S3_10_05)[3])
bd_lp2<-bd_lp2 %>% mutate(quitar_hijos=S3_10_06==unique(bd_lp2$S3_10_06)[1]|S3_10_06==unique(bd_lp2$S3_10_06)[2]|S3_10_06==unique(bd_lp2$S3_10_06)[3])
bd_lp2<-bd_lp2 %>% mutate(no_gast_casa=S3_10_07==unique(bd_lp2$S3_10_07)[1]|S3_10_07==unique(bd_lp2$S3_10_07)[2]|S3_10_07==unique(bd_lp2$S3_10_07)[3])
bd_lp2<-bd_lp2 %>% mutate(prohib_prop=S3_10_08==unique(bd_lp2$S3_10_08)[1]|S3_10_08==unique(bd_lp2$S3_10_08)[2]|S3_10_08==unique(bd_lp2$S3_10_08)[3])
bd_lp2<-bd_lp2 %>% mutate(destruido_cosas=S3_10_09==unique(bd_lp2$S3_10_09)[1]|S3_10_09==unique(bd_lp2$S3_10_09)[2]|S3_10_09==unique(bd_lp2$S3_10_09)[3])
bd_lp2<-bd_lp2 %>% mutate(quit_dinero=S3_10_10==unique(bd_lp2$S3_10_10)[1]|S3_10_10==unique(bd_lp2$S3_10_10)[2]|S3_10_10==unique(bd_lp2$S3_10_10)[3])
bd_lp2<-bd_lp2 %>% mutate(quit_bien=S3_10_11==unique(bd_lp2$S3_10_11)[1]|S3_10_11==unique(bd_lp2$S3_10_11)[2]|S3_10_11==unique(bd_lp2$S3_10_11)[3])
bd_lp2<-bd_lp2 %>% mutate(empujado=S3_10_12==unique(bd_lp2$S3_10_12)[1]|S3_10_12==unique(bd_lp2$S3_10_12)[2]|S3_10_12==unique(bd_lp2$S3_10_12)[3])
bd_lp2<-bd_lp2 %>% mutate(amenaza_armas=S3_10_17==unique(bd_lp2$S3_10_17)[1]|S3_10_17==unique(bd_lp2$S3_10_17)[2]|S3_10_17==unique(bd_lp2$S3_10_17)[3])
bd_lp2<-bd_lp2 %>% mutate(oblig_rela=S3_10_20==unique(bd_lp2$S3_10_20)[1]|S3_10_20==unique(bd_lp2$S3_10_20)[2]|S3_10_20==unique(bd_lp2$S3_10_20)[3])
bd_lp2<-bd_lp2 %>% mutate(exige_rela=S3_10_21==unique(bd_lp2$S3_10_21)[1]|S3_10_21==unique(bd_lp2$S3_10_21)[2]|S3_10_21==unique(bd_lp2$S3_10_21)[3])
bd_lp2<-bd_lp2 %>% mutate(obliga_no_gusta=S3_10_22==unique(bd_lp2$S3_10_22)[1]|S3_10_22==unique(bd_lp2$S3_10_22)[2]|S3_10_22==unique(bd_lp2$S3_10_22)[3])
bd_lp2<-bd_lp2 %>% dplyr::select(-c(1:16))
set.seed(123)
index = sample(1:2, nrow(bd_lp2), replace = TRUE, prob=c(0.7, 0.3))
prop.table(table(index))
trainbd<-bd_lp2[index==1,]
testbd<-bd_lp2[index==2,]
m1<-glm(ind_feminicidio~.,data=trainbd,family = binomial(link="logit"))
summary(m1)
m2<-step(m1)
summary(m2)
m1<-glm(ind_feminicidio~.-amenaza_armas,data=trainbd,family = binomial(link="logit"))
summary(m1)
m2<-step(m1)
summary(m2)
clase<-predict(m2,testbd,type="response")>0.5
table(clase)
table(testbd$ind_feminicidio,clase)
library(caret)
confusionMatrix(table(testbd$ind_feminicidio,clase))
library(mfx)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.5,xlim=c(-0.7,0.70),pos=-0.02)
bd_lp<-bd_cas %>% dplyr::select(aux)
bd_lp<-bd_lp %>% mutate(fem1=S3_10_13=="1. Muchas veces"|S3_10_14=="1. Muchas veces"|S3_10_15=="1. Muchas veces"|S3_10_16=="1. Muchas veces"|S3_10_18=="1. Muchas veces"|S3_10_19=="1. Muchas veces")
bd_lp<-bd_lp %>% mutate(fem2=S3_10_13=="2. Pocas veces"|S3_10_14=="2. Pocas veces"|S3_10_15=="2. Pocas veces"|S3_10_16=="2. Pocas veces"|S3_10_18=="2. Pocas veces"|S3_10_19=="2. Pocas veces")
#bd_lp<-bd_lp %>% mutate(fem3=S3_10_13=="3. Una vez"|S3_10_14=="3. Una vez"|S3_10_15=="3. Una vez"|S3_10_16=="3. Una vez"|S3_10_18=="3. Una vez"|S3_10_19=="3. Una vez")
#bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE|fem3==TRUE))
bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE))
aux2<-c("1. Muchas veces","2. Pocas veces","3. Una vez")
table(bd_lp$ind_feminicidio)
#var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2","fem3")
var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2")
bd_lp2<-bd_lp %>% dplyr::select(-var_elim)
Hmisc::describe(bd_lp2)
bd_lp2<-bd_lp2 %>% mutate(pal_gros=S3_10_01==unique(bd_lp2$S3_10_01)[1]|S3_10_01==unique(bd_lp2$S3_10_01)[2]|S3_10_01==unique(bd_lp2$S3_10_01)[3])
bd_lp2<-bd_lp2 %>% mutate(humillacion=S3_10_02==unique(bd_lp2$S3_10_02)[1]|S3_10_02==unique(bd_lp2$S3_10_02)[2]|S3_10_02==unique(bd_lp2$S3_10_02)[3])
bd_lp2<-bd_lp2 %>% mutate(prohib_sal=S3_10_03==unique(bd_lp2$S3_10_03)[1]|S3_10_03==unique(bd_lp2$S3_10_03)[2]|S3_10_03==unique(bd_lp2$S3_10_03)[3])
bd_lp2<-bd_lp2 %>% mutate(amenaza_last=S3_10_04==unique(bd_lp2$S3_10_04)[1]|S3_10_04==unique(bd_lp2$S3_10_04)[2]|S3_10_04==unique(bd_lp2$S3_10_04)[3])
bd_lp2<-bd_lp2 %>% mutate(amenaza_matar=S3_10_05==unique(bd_lp2$S3_10_05)[1]|S3_10_05==unique(bd_lp2$S3_10_05)[2]|S3_10_05==unique(bd_lp2$S3_10_05)[3])
bd_lp2<-bd_lp2 %>% mutate(quitar_hijos=S3_10_06==unique(bd_lp2$S3_10_06)[1]|S3_10_06==unique(bd_lp2$S3_10_06)[2]|S3_10_06==unique(bd_lp2$S3_10_06)[3])
bd_lp2<-bd_lp2 %>% mutate(no_gast_casa=S3_10_07==unique(bd_lp2$S3_10_07)[1]|S3_10_07==unique(bd_lp2$S3_10_07)[2]|S3_10_07==unique(bd_lp2$S3_10_07)[3])
bd_lp2<-bd_lp2 %>% mutate(prohib_prop=S3_10_08==unique(bd_lp2$S3_10_08)[1]|S3_10_08==unique(bd_lp2$S3_10_08)[2]|S3_10_08==unique(bd_lp2$S3_10_08)[3])
bd_lp2<-bd_lp2 %>% mutate(destruido_cosas=S3_10_09==unique(bd_lp2$S3_10_09)[1]|S3_10_09==unique(bd_lp2$S3_10_09)[2]|S3_10_09==unique(bd_lp2$S3_10_09)[3])
bd_lp2<-bd_lp2 %>% mutate(quit_dinero=S3_10_10==unique(bd_lp2$S3_10_10)[1]|S3_10_10==unique(bd_lp2$S3_10_10)[2]|S3_10_10==unique(bd_lp2$S3_10_10)[3])
bd_lp2<-bd_lp2 %>% mutate(quit_bien=S3_10_11==unique(bd_lp2$S3_10_11)[1]|S3_10_11==unique(bd_lp2$S3_10_11)[2]|S3_10_11==unique(bd_lp2$S3_10_11)[3])
bd_lp2<-bd_lp2 %>% mutate(empujado=S3_10_12==unique(bd_lp2$S3_10_12)[1]|S3_10_12==unique(bd_lp2$S3_10_12)[2]|S3_10_12==unique(bd_lp2$S3_10_12)[3])
bd_lp2<-bd_lp2 %>% mutate(amenaza_armas=S3_10_17==unique(bd_lp2$S3_10_17)[1]|S3_10_17==unique(bd_lp2$S3_10_17)[2]|S3_10_17==unique(bd_lp2$S3_10_17)[3])
bd_lp2<-bd_lp2 %>% mutate(oblig_rela=S3_10_20==unique(bd_lp2$S3_10_20)[1]|S3_10_20==unique(bd_lp2$S3_10_20)[2]|S3_10_20==unique(bd_lp2$S3_10_20)[3])
bd_lp2<-bd_lp2 %>% mutate(exige_rela=S3_10_21==unique(bd_lp2$S3_10_21)[1]|S3_10_21==unique(bd_lp2$S3_10_21)[2]|S3_10_21==unique(bd_lp2$S3_10_21)[3])
bd_lp2<-bd_lp2 %>% mutate(obliga_no_gusta=S3_10_22==unique(bd_lp2$S3_10_22)[1]|S3_10_22==unique(bd_lp2$S3_10_22)[2]|S3_10_22==unique(bd_lp2$S3_10_22)[3])
bd_lp2<-bd_lp2 %>% dplyr::select(-c(1:16))
Hmisc::describe(bd_lp2)
library(dplyr)
aux<-seq(284,347,3)
bd_lp<-bd_cas %>% dplyr::select(aux)
Hmisc::describe(bd_lp)
bd_lp<-bd_lp %>% mutate(fem1=S3_10_13=="1. Muchas veces"|S3_10_14=="1. Muchas veces"|S3_10_15=="1. Muchas veces"|S3_10_16=="1. Muchas veces"|S3_10_18=="1. Muchas veces"|S3_10_19=="1. Muchas veces")
bd_lp<-bd_lp %>% mutate(fem2=S3_10_13=="2. Pocas veces"|S3_10_14=="2. Pocas veces"|S3_10_15=="2. Pocas veces"|S3_10_16=="2. Pocas veces"|S3_10_18=="2. Pocas veces"|S3_10_19=="2. Pocas veces")
#bd_lp<-bd_lp %>% mutate(fem3=S3_10_13=="3. Una vez"|S3_10_14=="3. Una vez"|S3_10_15=="3. Una vez"|S3_10_16=="3. Una vez"|S3_10_18=="3. Una vez"|S3_10_19=="3. Una vez")
#bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE|fem3==TRUE))
bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE))
table(bd_lp$ind_feminicidio)
Hmisc::describe(bd_lp)
bd_lp2<-bd_lp2 %>% mutate(pal_gros=S3_10_01==unique(bd_lp2$S3_10_01)[1]|S3_10_01==unique(bd_lp2$S3_10_01)[2]|S3_10_01==unique(bd_lp2$S3_10_01)[3])
bd_lp2<-bd_lp2 %>% mutate(humillacion=S3_10_02==unique(bd_lp2$S3_10_02)[1]|S3_10_02==unique(bd_lp2$S3_10_02)[2]|S3_10_02==unique(bd_lp2$S3_10_02)[3])
bd_lp<-bd_cas %>% dplyr::select(aux)
str(bd_lp)
Hmisc::describe(bd_lp)
bd_lp<-bd_lp %>% mutate(fem1=S3_10_13=="1. Muchas veces"|S3_10_14=="1. Muchas veces"|S3_10_15=="1. Muchas veces"|S3_10_16=="1. Muchas veces"|S3_10_18=="1. Muchas veces"|S3_10_19=="1. Muchas veces")
bd_lp<-bd_lp %>% mutate(fem2=S3_10_13=="2. Pocas veces"|S3_10_14=="2. Pocas veces"|S3_10_15=="2. Pocas veces"|S3_10_16=="2. Pocas veces"|S3_10_18=="2. Pocas veces"|S3_10_19=="2. Pocas veces")
#bd_lp<-bd_lp %>% mutate(fem3=S3_10_13=="3. Una vez"|S3_10_14=="3. Una vez"|S3_10_15=="3. Una vez"|S3_10_16=="3. Una vez"|S3_10_18=="3. Una vez"|S3_10_19=="3. Una vez")
#bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE|fem3==TRUE))
bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE))
aux2<-c("1. Muchas veces","2. Pocas veces","3. Una vez")
table(bd_lp$ind_feminicidio)
#var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2","fem3")
var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2")
Hmisc::describe(bd_lp)
bd_lp2<-bd_lp %>% dplyr::select(-var_elim)
Hmisc::describe(bd_lp2)
bd_lp2<-bd_lp2 %>% mutate(pal_gros=S3_10_01==unique(bd_lp2$S3_10_01)[1]|S3_10_01==unique(bd_lp2$S3_10_01)[2]|S3_10_01==unique(bd_lp2$S3_10_01)[3])
bd_lp2<-bd_lp2 %>% mutate(humillacion=S3_10_02==unique(bd_lp2$S3_10_02)[1]|S3_10_02==unique(bd_lp2$S3_10_02)[2]|S3_10_02==unique(bd_lp2$S3_10_02)[3])
bd_lp2<-bd_lp2 %>% mutate(prohib_sal=S3_10_03==unique(bd_lp2$S3_10_03)[1]|S3_10_03==unique(bd_lp2$S3_10_03)[2]|S3_10_03==unique(bd_lp2$S3_10_03)[3])
bd_lp2<-bd_lp2 %>% mutate(amenaza_last=S3_10_04==unique(bd_lp2$S3_10_04)[1]|S3_10_04==unique(bd_lp2$S3_10_04)[2]|S3_10_04==unique(bd_lp2$S3_10_04)[3])
bd_lp2<-bd_lp2 %>% mutate(amenaza_matar=S3_10_05==unique(bd_lp2$S3_10_05)[1]|S3_10_05==unique(bd_lp2$S3_10_05)[2]|S3_10_05==unique(bd_lp2$S3_10_05)[3])
bd_lp2<-bd_lp2 %>% mutate(quitar_hijos=S3_10_06==unique(bd_lp2$S3_10_06)[1]|S3_10_06==unique(bd_lp2$S3_10_06)[2]|S3_10_06==unique(bd_lp2$S3_10_06)[3])
bd_lp2<-bd_lp2 %>% mutate(no_gast_casa=S3_10_07==unique(bd_lp2$S3_10_07)[1]|S3_10_07==unique(bd_lp2$S3_10_07)[2]|S3_10_07==unique(bd_lp2$S3_10_07)[3])
bd_lp2<-bd_lp2 %>% mutate(prohib_prop=S3_10_08==unique(bd_lp2$S3_10_08)[1]|S3_10_08==unique(bd_lp2$S3_10_08)[2]|S3_10_08==unique(bd_lp2$S3_10_08)[3])
bd_lp2<-bd_lp2 %>% mutate(destruido_cosas=S3_10_09==unique(bd_lp2$S3_10_09)[1]|S3_10_09==unique(bd_lp2$S3_10_09)[2]|S3_10_09==unique(bd_lp2$S3_10_09)[3])
bd_lp2<-bd_lp2 %>% mutate(quit_dinero=S3_10_10==unique(bd_lp2$S3_10_10)[1]|S3_10_10==unique(bd_lp2$S3_10_10)[2]|S3_10_10==unique(bd_lp2$S3_10_10)[3])
bd_lp2<-bd_lp2 %>% mutate(quit_bien=S3_10_11==unique(bd_lp2$S3_10_11)[1]|S3_10_11==unique(bd_lp2$S3_10_11)[2]|S3_10_11==unique(bd_lp2$S3_10_11)[3])
bd_lp2<-bd_lp2 %>% mutate(empujado=S3_10_12==unique(bd_lp2$S3_10_12)[1]|S3_10_12==unique(bd_lp2$S3_10_12)[2]|S3_10_12==unique(bd_lp2$S3_10_12)[3])
bd_lp2<-bd_lp2 %>% mutate(amenaza_armas=S3_10_17==unique(bd_lp2$S3_10_17)[1]|S3_10_17==unique(bd_lp2$S3_10_17)[2]|S3_10_17==unique(bd_lp2$S3_10_17)[3])
bd_lp2<-bd_lp2 %>% mutate(oblig_rela=S3_10_20==unique(bd_lp2$S3_10_20)[1]|S3_10_20==unique(bd_lp2$S3_10_20)[2]|S3_10_20==unique(bd_lp2$S3_10_20)[3])
bd_lp2<-bd_lp2 %>% mutate(exige_rela=S3_10_21==unique(bd_lp2$S3_10_21)[1]|S3_10_21==unique(bd_lp2$S3_10_21)[2]|S3_10_21==unique(bd_lp2$S3_10_21)[3])
bd_lp2<-bd_lp2 %>% mutate(obliga_no_gusta=S3_10_22==unique(bd_lp2$S3_10_22)[1]|S3_10_22==unique(bd_lp2$S3_10_22)[2]|S3_10_22==unique(bd_lp2$S3_10_22)[3])
bd_lp2<-bd_lp2 %>% dplyr::select(-c(1:16))
Hmisc::describe(bd_lp2)
levels(bd_lp$S3_10_01)
bd_lp<-bd_cas %>% dplyr::select(aux)
str(bd_lp)
Hmisc::describe(bd_lp)
bd_lp<-bd_lp %>% mutate(fem1=S3_10_13=="1. Muchas veces"|S3_10_14=="1. Muchas veces"|S3_10_15=="1. Muchas veces"|S3_10_16=="1. Muchas veces"|S3_10_18=="1. Muchas veces"|S3_10_19=="1. Muchas veces")
bd_lp<-bd_lp %>% mutate(fem2=S3_10_13=="2. Pocas veces"|S3_10_14=="2. Pocas veces"|S3_10_15=="2. Pocas veces"|S3_10_16=="2. Pocas veces"|S3_10_18=="2. Pocas veces"|S3_10_19=="2. Pocas veces")
#bd_lp<-bd_lp %>% mutate(fem3=S3_10_13=="3. Una vez"|S3_10_14=="3. Una vez"|S3_10_15=="3. Una vez"|S3_10_16=="3. Una vez"|S3_10_18=="3. Una vez"|S3_10_19=="3. Una vez")
#bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE|fem3==TRUE))
bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE))
aux2<-c("1. Muchas veces","2. Pocas veces","3. Una vez")
table(bd_lp$ind_feminicidio)
#var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2","fem3")
var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2")
Hmisc::describe(bd_lp)
bd_lp2<-bd_lp %>% dplyr::select(-var_elim)
Hmisc::describe(bd_lp2)
bd_lp2<-bd_lp2 %>% mutate(pal_gros=S3_10_01=="1. Muchas veces"|S3_10_01=="2. Pocas veces"|S3_10_01=="3. Una vez")
table(bd_lp2$pal_gros)
bd_lp2<-bd_lp2 %>% mutate(humillacion=S3_10_02=="1. Muchas veces"|S3_10_02=="2. Pocas veces"|S3_10_02=="3. Una vez")
table(bd_lp2$humillacion)
bd_lp2<-bd_lp2 %>% mutate(prohib_sal=S3_10_03=="1. Muchas veces"|S3_10_03=="2. Pocas veces"|S3_10_03=="3. Una vez")
table(bd_lp2$prohib_sal)
bd_lp2<-bd_lp2 %>% mutate(amenaza_last=S3_10_04=="1. Muchas veces"|S3_10_04=="2. Pocas veces"|S3_10_04=="3. Una vez")
library(dplyr)
aux<-seq(284,347,3)
bd_lp<-bd_cas %>% dplyr::select(aux)
str(bd_lp)
Hmisc::describe(bd_lp)
levels(bd_lp$S3_10_13)
table(is.na(bd_lp))
bd_lp<-bd_lp %>% mutate(fem1=S3_10_13=="1. Muchas veces"|S3_10_14=="1. Muchas veces"|S3_10_15=="1. Muchas veces"|S3_10_16=="1. Muchas veces"|S3_10_18=="1. Muchas veces"|S3_10_19=="1. Muchas veces")
bd_lp<-bd_lp %>% mutate(fem2=S3_10_13=="2. Pocas veces"|S3_10_14=="2. Pocas veces"|S3_10_15=="2. Pocas veces"|S3_10_16=="2. Pocas veces"|S3_10_18=="2. Pocas veces"|S3_10_19=="2. Pocas veces")
#bd_lp<-bd_lp %>% mutate(fem3=S3_10_13=="3. Una vez"|S3_10_14=="3. Una vez"|S3_10_15=="3. Una vez"|S3_10_16=="3. Una vez"|S3_10_18=="3. Una vez"|S3_10_19=="3. Una vez")
#bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE|fem3==TRUE))
bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE))
aux2<-c("1. Muchas veces","2. Pocas veces","3. Una vez")
table(bd_lp$ind_feminicidio)
#var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2","fem3")
var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2")
Hmisc::describe(bd_lp)
bd_lp2<-bd_lp %>% dplyr::select(-var_elim)
Hmisc::describe(bd_lp2)
bd_lp2<-bd_lp2 %>% mutate(pal_gros=S3_10_01=="1. Muchas veces"|S3_10_01=="2. Pocas veces"|S3_10_01=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(humillacion=S3_10_02=="1. Muchas veces"|S3_10_02=="2. Pocas veces"|S3_10_02=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(prohib_sal=S3_10_03=="1. Muchas veces"|S3_10_03=="2. Pocas veces"|S3_10_03=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(amenaza_last=S3_10_04=="1. Muchas veces"|S3_10_04=="2. Pocas veces"|S3_10_04=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(amenaza_matar=S3_10_05=="1. Muchas veces"|S3_10_05=="2. Pocas veces"|S3_10_05=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(quitar_hijos=S3_10_06=="1. Muchas veces"|S3_10_06=="2. Pocas veces"|S3_10_06=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(no_gast_casa=S3_10_07=="1. Muchas veces"|S3_10_07=="2. Pocas veces"|S3_10_07=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(prohib_prop=S3_10_08=="1. Muchas veces"|S3_10_08=="2. Pocas veces"|S3_10_08=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(destruido_cosas=S3_10_09=="1. Muchas veces"|S3_10_09=="2. Pocas veces"|S3_10_09=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(quit_dinero=S3_10_10=="1. Muchas veces"|S3_10_10=="2. Pocas veces"|S3_10_10=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(quit_bien=S3_10_11=="1. Muchas veces"|S3_10_11=="2. Pocas veces"|S3_10_11=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(empujado=S3_10_12=="1. Muchas veces"|S3_10_12=="2. Pocas veces"|S3_10_12=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(amenaza_armas=S3_10_17=="1. Muchas veces"|S3_10_17=="2. Pocas veces"|S3_10_17=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(oblig_rela=S3_10_20=="1. Muchas veces"|S3_10_20=="2. Pocas veces"|S3_10_20=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(exige_rela=S3_10_21=="1. Muchas veces"|S3_10_21=="2. Pocas veces"|S3_10_21=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(obliga_no_gusta=S3_10_22=="1. Muchas veces"|S3_10_22=="2. Pocas veces"|S3_10_22=="3. Una vez")
bd_lp2<-bd_lp2 %>% dplyr::select(-c(1:16))
Hmisc::describe(bd_lp2)
set.seed(123)
index = sample(1:2, nrow(bd_lp2), replace = TRUE, prob=c(0.7, 0.3))
prop.table(table(index))
trainbd<-bd_lp2[index==1,]
testbd<-bd_lp2[index==2,]
m1<-glm(ind_feminicidio~.,data=trainbd,family = binomial(link="logit"))
summary(m1)
m2<-step(m1)
summary(m2)
clase<-predict(m2,testbd,type="response")>0.5
table(clase)
table(testbd$ind_feminicidio,clase)
library(caret)
confusionMatrix(table(testbd$ind_feminicidio,clase))
library(mfx)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.5,xlim=c(-0.7,0.70),pos=-0.02)
title("Principales Variables de Indicio de Feminicidio
Modelo Logit(Efectos Marginales)")
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.7,0.70),pos=-0.02)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.1,0.5),pos=-0.02)
summary(m2)
summary(m2)
summary(m1)
m1<-glm(ind_feminicidio~.-quit_bien,data=trainbd,family = binomial(link="logit"))
summary(m1)
m2<-step(m1)
summary(m2)
clase<-predict(m2,testbd,type="response")>0.5
table(clase)
table(testbd$ind_feminicidio,clase)
library(caret)
confusionMatrix(table(testbd$ind_feminicidio,clase))
library(mfx)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.1,0.5),pos=-0.02)
title("Principales Variables de Indicio de Feminicidio
Modelo Logit(Efectos Marginales)")
bd_lp<-bd_cas %>% dplyr::select(aux)
bd_lp<-bd_lp %>% mutate(fem1=S3_10_13=="1. Muchas veces"|S3_10_14=="1. Muchas veces"|S3_10_15=="1. Muchas veces"|S3_10_16=="1. Muchas veces"|S3_10_18=="1. Muchas veces"|S3_10_19=="1. Muchas veces")
bd_lp<-bd_lp %>% mutate(fem2=S3_10_13=="2. Pocas veces"|S3_10_14=="2. Pocas veces"|S3_10_15=="2. Pocas veces"|S3_10_16=="2. Pocas veces"|S3_10_18=="2. Pocas veces"|S3_10_19=="2. Pocas veces")
bd_lp<-bd_lp %>% mutate(fem3=S3_10_13=="3. Una vez"|S3_10_14=="3. Una vez"|S3_10_15=="3. Una vez"|S3_10_16=="3. Una vez"|S3_10_18=="3. Una vez"|S3_10_19=="3. Una vez")
bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE|fem3==TRUE))
aux2<-c("1. Muchas veces","2. Pocas veces","3. Una vez")
table(bd_lp$ind_feminicidio)
var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2","fem3")
bd_lp2<-bd_lp %>% dplyr::select(-var_elim)
bd_lp2<-bd_lp2 %>% mutate(pal_gros=S3_10_01=="1. Muchas veces"|S3_10_01=="2. Pocas veces"|S3_10_01=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(humillacion=S3_10_02=="1. Muchas veces"|S3_10_02=="2. Pocas veces"|S3_10_02=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(prohib_sal=S3_10_03=="1. Muchas veces"|S3_10_03=="2. Pocas veces"|S3_10_03=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(amenaza_last=S3_10_04=="1. Muchas veces"|S3_10_04=="2. Pocas veces"|S3_10_04=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(amenaza_matar=S3_10_05=="1. Muchas veces"|S3_10_05=="2. Pocas veces"|S3_10_05=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(quitar_hijos=S3_10_06=="1. Muchas veces"|S3_10_06=="2. Pocas veces"|S3_10_06=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(no_gast_casa=S3_10_07=="1. Muchas veces"|S3_10_07=="2. Pocas veces"|S3_10_07=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(prohib_prop=S3_10_08=="1. Muchas veces"|S3_10_08=="2. Pocas veces"|S3_10_08=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(destruido_cosas=S3_10_09=="1. Muchas veces"|S3_10_09=="2. Pocas veces"|S3_10_09=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(quit_dinero=S3_10_10=="1. Muchas veces"|S3_10_10=="2. Pocas veces"|S3_10_10=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(quit_bien=S3_10_11=="1. Muchas veces"|S3_10_11=="2. Pocas veces"|S3_10_11=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(empujado=S3_10_12=="1. Muchas veces"|S3_10_12=="2. Pocas veces"|S3_10_12=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(amenaza_armas=S3_10_17=="1. Muchas veces"|S3_10_17=="2. Pocas veces"|S3_10_17=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(oblig_rela=S3_10_20=="1. Muchas veces"|S3_10_20=="2. Pocas veces"|S3_10_20=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(exige_rela=S3_10_21=="1. Muchas veces"|S3_10_21=="2. Pocas veces"|S3_10_21=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(obliga_no_gusta=S3_10_22=="1. Muchas veces"|S3_10_22=="2. Pocas veces"|S3_10_22=="3. Una vez")
bd_lp2<-bd_lp2 %>% dplyr::select(-c(1:16))
set.seed(123)
index = sample(1:2, nrow(bd_lp2), replace = TRUE, prob=c(0.7, 0.3))
prop.table(table(index))
trainbd<-bd_lp2[index==1,]
testbd<-bd_lp2[index==2,]
m1<-glm(ind_feminicidio~.,data=trainbd,family = binomial(link="logit"))
summary(m1)
m2<-step(m1)
summary(m2)
clase<-predict(m2,testbd,type="response")>0.5
table(clase)
table(testbd$ind_feminicidio,clase)
library(caret)
confusionMatrix(table(testbd$ind_feminicidio,clase))
library(mfx)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.1,0.5),pos=-0.02)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.8,xlim=c(-0.1,0.5),pos=-0.02)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7xlim=c(-0.1,0.7),pos=-0.02)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.1,0.7),pos=-0.02)
summary(m2)
summary(m2)
m1<-glm(ind_feminicidio~.,data=trainbd,family = binomial(link="logit"))
summary(m1)
m1<-glm(ind_feminicidio~.obliga_no_gusta,data=trainbd,family = binomial(link="logit"))
m1<-glm(ind_feminicidio~.obliga_no_gusta,data=trainbd,family = binomial(link="logit"))
m1<-glm(ind_feminicidio~.-obliga_no_gusta,data=trainbd,family = binomial(link="logit"))
summary(m1)
m2<-step(m1)
summary(m2)
clase<-predict(m2,testbd,type="response")>0.5
table(clase)
table(testbd$ind_feminicidio,clase)
library(caret)
confusionMatrix(table(testbd$ind_feminicidio,clase))
library(mfx)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.1,0.7),pos=-0.02)
m1<-glm(ind_feminicidio~.-quit_dinero,data=trainbd,family = binomial(link="logit"))
m1<-glm(ind_feminicidio~.-quit_dinero,data=trainbd,family = binomial(link="logit"))
summary(m1)
m2<-step(m1)
summary(m2)
clase<-predict(m2,testbd,type="response")>0.5
table(clase)
table(testbd$ind_feminicidio,clase)
library(caret)
confusionMatrix(table(testbd$ind_feminicidio,clase))
library(mfx)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.1,0.7),pos=-0.02)
m1<-glm(ind_feminicidio~.,data=trainbd,family = binomial(link="logit"))
m1<-glm(ind_feminicidio~.,data=trainbd,family = binomial(link="logit"))
summary(m1)
m2<-step(m1)
summary(m2)
clase<-predict(m2,testbd,type="response")>0.5
table(clase)
table(testbd$ind_feminicidio,clase)
library(caret)
confusionMatrix(table(testbd$ind_feminicidio,clase))
library(mfx)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.1,0.7),pos=-0.02)
aux<-seq(284,347,3)
bd_lp<-bd_cas %>% dplyr::select(aux)
levels(bd_lp$S3_10_13)
table(is.na(bd_lp))
bd_lp<-bd_lp %>% mutate(fem1=S3_10_13=="1. Muchas veces"|S3_10_14=="1. Muchas veces"|S3_10_15=="1. Muchas veces"|S3_10_16=="1. Muchas veces"|S3_10_18=="1. Muchas veces"|S3_10_19=="1. Muchas veces")
bd_lp<-bd_lp %>% mutate(fem2=S3_10_13=="2. Pocas veces"|S3_10_14=="2. Pocas veces"|S3_10_15=="2. Pocas veces"|S3_10_16=="2. Pocas veces"|S3_10_18=="2. Pocas veces"|S3_10_19=="2. Pocas veces")
#bd_lp<-bd_lp %>% mutate(fem3=S3_10_13=="3. Una vez"|S3_10_14=="3. Una vez"|S3_10_15=="3. Una vez"|S3_10_16=="3. Una vez"|S3_10_18=="3. Una vez"|S3_10_19=="3. Una vez")
#bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE|fem3==TRUE))
bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE))
aux2<-c("1. Muchas veces","2. Pocas veces","3. Una vez")
table(bd_lp$ind_feminicidio)
#var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2","fem3")
var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2")
Hmisc::describe(bd_lp)
bd_lp2<-bd_lp %>% dplyr::select(-var_elim)
Hmisc::describe(bd_lp2)
bd_lp2<-bd_lp2 %>% mutate(pal_gros=S3_10_01=="1. Muchas veces"|S3_10_01=="2. Pocas veces"|S3_10_01=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(humillacion=S3_10_02=="1. Muchas veces"|S3_10_02=="2. Pocas veces"|S3_10_02=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(prohib_sal=S3_10_03=="1. Muchas veces"|S3_10_03=="2. Pocas veces"|S3_10_03=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(amenaza_last=S3_10_04=="1. Muchas veces"|S3_10_04=="2. Pocas veces"|S3_10_04=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(amenaza_matar=S3_10_05=="1. Muchas veces"|S3_10_05=="2. Pocas veces"|S3_10_05=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(quitar_hijos=S3_10_06=="1. Muchas veces"|S3_10_06=="2. Pocas veces"|S3_10_06=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(no_gast_casa=S3_10_07=="1. Muchas veces"|S3_10_07=="2. Pocas veces"|S3_10_07=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(prohib_prop=S3_10_08=="1. Muchas veces"|S3_10_08=="2. Pocas veces"|S3_10_08=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(destruido_cosas=S3_10_09=="1. Muchas veces"|S3_10_09=="2. Pocas veces"|S3_10_09=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(quit_dinero=S3_10_10=="1. Muchas veces"|S3_10_10=="2. Pocas veces"|S3_10_10=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(quit_bien=S3_10_11=="1. Muchas veces"|S3_10_11=="2. Pocas veces"|S3_10_11=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(empujado=S3_10_12=="1. Muchas veces"|S3_10_12=="2. Pocas veces"|S3_10_12=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(amenaza_armas=S3_10_17=="1. Muchas veces"|S3_10_17=="2. Pocas veces"|S3_10_17=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(oblig_rela=S3_10_20=="1. Muchas veces"|S3_10_20=="2. Pocas veces"|S3_10_20=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(exige_rela=S3_10_21=="1. Muchas veces"|S3_10_21=="2. Pocas veces"|S3_10_21=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(obliga_no_gusta=S3_10_22=="1. Muchas veces"|S3_10_22=="2. Pocas veces"|S3_10_22=="3. Una vez")
bd_lp2<-bd_lp2 %>% dplyr::select(-c(1:16))
Hmisc::describe(bd_lp2)
set.seed(123)
index = sample(1:2, nrow(bd_lp2), replace = TRUE, prob=c(0.7, 0.3))
prop.table(table(index))
trainbd<-bd_lp2[index==1,]
testbd<-bd_lp2[index==2,]
m1<-glm(ind_feminicidio~.,data=trainbd,family = binomial(link="logit"))
summary(m1)
m2<-step(m1)
summary(m2)
clase<-predict(m2,testbd,type="response")>0.5
table(clase)
table(testbd$ind_feminicidio,clase)
library(caret)
confusionMatrix(table(testbd$ind_feminicidio,clase))
library(mfx)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.1,0.7),pos=-0.02)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2
load("C:\\Users\\Dell\\Documents\\GitHub\\mi_proyecto1_EST_384\\proy_MineriaDatos\\bd_proy\\bd_cas.RData")
# Chunk 3
library(dplyr)
aux<-seq(284,347,3)
bd_lp<-bd_cas %>% dplyr::select(aux)
str(bd_lp)
Hmisc::describe(bd_lp)
# Chunk 4
levels(bd_lp$S3_10_13)
table(is.na(bd_lp))
bd_lp<-bd_lp %>% mutate(fem1=S3_10_13=="1. Muchas veces"|S3_10_14=="1. Muchas veces"|S3_10_15=="1. Muchas veces"|S3_10_16=="1. Muchas veces"|S3_10_18=="1. Muchas veces"|S3_10_19=="1. Muchas veces")
bd_lp<-bd_lp %>% mutate(fem2=S3_10_13=="2. Pocas veces"|S3_10_14=="2. Pocas veces"|S3_10_15=="2. Pocas veces"|S3_10_16=="2. Pocas veces"|S3_10_18=="2. Pocas veces"|S3_10_19=="2. Pocas veces")
bd_lp<-bd_lp %>% mutate(fem3=S3_10_13=="3. Una vez"|S3_10_14=="3. Una vez"|S3_10_15=="3. Una vez"|S3_10_16=="3. Una vez"|S3_10_18=="3. Una vez"|S3_10_19=="3. Una vez")
bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE|fem3==TRUE))
#bd_lp<-bd_lp %>% mutate(ind_feminicidio=(fem1==TRUE|fem2==TRUE))
aux2<-c("1. Muchas veces","2. Pocas veces","3. Una vez")
table(bd_lp$ind_feminicidio)
var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2","fem3")
#var_elim<-c("S3_10_13","S3_10_14","S3_10_15","S3_10_16","S3_10_18","S3_10_19","fem1","fem2")
Hmisc::describe(bd_lp)
bd_lp2<-bd_lp %>% dplyr::select(-var_elim)
Hmisc::describe(bd_lp2)
# Chunk 5
bd_lp2<-bd_lp2 %>% mutate(pal_gros=S3_10_01=="1. Muchas veces"|S3_10_01=="2. Pocas veces"|S3_10_01=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(humillacion=S3_10_02=="1. Muchas veces"|S3_10_02=="2. Pocas veces"|S3_10_02=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(prohib_sal=S3_10_03=="1. Muchas veces"|S3_10_03=="2. Pocas veces"|S3_10_03=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(amenaza_last=S3_10_04=="1. Muchas veces"|S3_10_04=="2. Pocas veces"|S3_10_04=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(amenaza_matar=S3_10_05=="1. Muchas veces"|S3_10_05=="2. Pocas veces"|S3_10_05=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(quitar_hijos=S3_10_06=="1. Muchas veces"|S3_10_06=="2. Pocas veces"|S3_10_06=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(no_gast_casa=S3_10_07=="1. Muchas veces"|S3_10_07=="2. Pocas veces"|S3_10_07=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(prohib_prop=S3_10_08=="1. Muchas veces"|S3_10_08=="2. Pocas veces"|S3_10_08=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(destruido_cosas=S3_10_09=="1. Muchas veces"|S3_10_09=="2. Pocas veces"|S3_10_09=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(quit_dinero=S3_10_10=="1. Muchas veces"|S3_10_10=="2. Pocas veces"|S3_10_10=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(quit_bien=S3_10_11=="1. Muchas veces"|S3_10_11=="2. Pocas veces"|S3_10_11=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(empujado=S3_10_12=="1. Muchas veces"|S3_10_12=="2. Pocas veces"|S3_10_12=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(amenaza_armas=S3_10_17=="1. Muchas veces"|S3_10_17=="2. Pocas veces"|S3_10_17=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(oblig_rela=S3_10_20=="1. Muchas veces"|S3_10_20=="2. Pocas veces"|S3_10_20=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(exige_rela=S3_10_21=="1. Muchas veces"|S3_10_21=="2. Pocas veces"|S3_10_21=="3. Una vez")
bd_lp2<-bd_lp2 %>% mutate(obliga_no_gusta=S3_10_22=="1. Muchas veces"|S3_10_22=="2. Pocas veces"|S3_10_22=="3. Una vez")
bd_lp2<-bd_lp2 %>% dplyr::select(-c(1:16))
Hmisc::describe(bd_lp2)
# Chunk 6
set.seed(123)
index = sample(1:2, nrow(bd_lp2), replace = TRUE, prob=c(0.7, 0.3))
prop.table(table(index))
trainbd<-bd_lp2[index==1,]
testbd<-bd_lp2[index==2,]
# Chunk 7
m1<-glm(ind_feminicidio~.,data=trainbd,family = binomial(link="logit"))
# Chunk 8
summary(m1)
m2<-step(m1)
summary(m2)
# Chunk 9
clase<-predict(m2,testbd,type="response")>0.5
table(clase)
# Chunk 10
table(testbd$ind_feminicidio,clase)
# Chunk 11
library(caret)
confusionMatrix(table(testbd$ind_feminicidio,clase))
# Chunk 12
library(mfx)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.1,0.7),pos=-0.02)
title("Principales Variables de Indicio de Feminicidio
Modelo Logit(Efectos Marginales)")
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.1,0.7))#,pos=-0.02)
info<-logitmfx(formula(m2),data=testbd)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.1,0.7),pos=0.02)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.1,0.7),pos=-0.02)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.1,0.7),pos=0.02)
barplot(info$mfxest[,1],horiz = T,las=1,cex.names = 0.7,xlim=c(-0.1,0.7),pos=-0.02)
title("Principales Variables de Indicio de Feminicidio
Modelo Logit(Efectos Marginales)")
info
info
info$mfxest
